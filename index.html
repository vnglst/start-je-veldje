<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Start je Veldje</title>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/startscreen.css" />
  </head>
  <body>
    <!-- Beginscherm overlay -->
    <div id="startscreen" class="startscreen-overlay">
      <h1 class="startscreen-title">🌱 Start je Veldje 🌾</h1>
      <div class="startscreen-box">
        <div class="startscreen-welcome">Welkom terug op je boerderij!</div>
        <ul class="startscreen-stats">
          <li>💰 Geld: <span id="begin-money">...</span></li>
          <li>🌱 Zaden: <span id="begin-seeds">...</span></li>
          <li>🍎 Fruit: <span id="begin-fruit">...</span></li>
          <li>🍦 IJs: <span id="begin-ice">...</span></li>
          <li>💧 Water: <span id="begin-water">...</span></li>
          <li>📅 Dag: <span id="begin-day">...</span></li>
          <li>🌸 Seizoen: <span id="begin-season">...</span></li>
        </ul>
        <button id="startSpelBtn" class="startscreen-btn">Starten</button>
      </div>
      <div class="startscreen-tip">Tip: Zet geluid aan voor de beste ervaring!</div>
    </div>
    <div class="game-container" id="gameContainer" class="startscreen-blur">
      <h1>🌱 Start je Veldje 🌾</h1>

      <div class="game-stats">
        <div class="stat">💰 Geld: €<span id="money">100</span></div>
        <div class="stat">🌱 Zaden: <span id="seedCount">0</span></div>
        <div class="stat">🍎 Fruit: <span id="fruitCount">0</span></div>
        <div class="stat">🍦 IJs: <span id="iceCreamCount">0</span></div>
        <div class="stat">💧 Water: <span id="water">10</span></div>
        <div class="stat">📅 Dag: <span id="day">1</span></div>
        <div class="stat">🌸 <span id="season">Lente</span></div>
        <div class="stat greenhouse-stat" id="greenhouseStat" style="display: none">🏡 Kas: ✅</div>
      </div>

      <div class="game-area">
        <div class="farm-area">
          <h3 style="text-align: center; color: #8b4513; margin-bottom: 15px" id="farmTitle">🚜 Je Boerderij</h3>

          <!-- Game map with farm and well -->
          <div class="game-map" id="gameMap">
            <!-- Farm plots and well will be generated here -->
          </div>

          <p style="text-align: center; color: #8b4513; font-style: italic; margin-top: 10px; font-size: 0.9em">
            Gebruik pijltjestoetsen om te bewegen! Ga naar de winkel 🏪, ijswinkel 🍦, ijsmachine 🏭, put 🏗️ en kas 🏡.
          </p>

          <div class="help-section">
            <details>
              <summary
                style="
                  color: #b8860b;
                  font-weight: bold;
                  cursor: pointer;
                  padding: 8px;
                  background: #fff8dc;
                  border-radius: 6px;
                  margin-bottom: 5px;
                "
              >
                📖 Hoe te spelen (klik om uit te klappen)
              </summary>
              <div
                style="
                  background: #fff8dc;
                  border: 2px solid #daa520;
                  border-radius: 8px;
                  padding: 10px;
                  font-size: 0.85em;
                "
              >
                <ul style="color: #8b4513; line-height: 1.3; padding-left: 20px; margin: 0">
                  <li>🏪 Loop naar de winkel om zaden te kopen</li>
                  <li>🍦 Bezoek de ijswinkel voor een geluksboost</li>
                  <li>🏭 Gebruik de ijsmachine om fruit te verwerken tot ijs</li>
                  <li>💰 Verkoop ijs voor meer winst dan gewoon fruit!</li>
                  <li>🍓 Maak je eigen ijs van verbouwde vruchten!</li>
                  <li>🚶 Beweeg naar een leeg veldje</li>
                  <li>🌱 Klik om te planten</li>
                  <li>🚿 Gebruik gieter mode om water te geven</li>
                  <li>💧 Haal water bij de put 🏗️</li>
                  <li>🔍 Gebruik info mode voor plantdetails</li>
                  <li>🎯 Oogst rijpe gewassen</li>
                  <li>🏡 Koop een kas voor speciale gewassen</li>
                  <li>⌨️ Druk spatie bij gebouwen voor interactie</li>
                </ul>
              </div>
            </details>
          </div>
        </div>

        <div class="sidebar">
          <!-- Tab Navigation -->
          <div class="tab-navigation">
            <button class="tab-button active" onclick="speelTabWisselGeluid(); showTab('inventory')">
              📦 Inventaris
            </button>
            <button class="tab-button" onclick="speelTabWisselGeluid(); showTab('tools')">🛠️ Tools</button>
            <button class="tab-button" onclick="speelTabWisselGeluid(); showTab('season')">📅 Seizoen</button>
          </div>

          <!-- Tab Content -->
          <div class="tab-content">
            <!-- Inventory Tab -->
            <div id="tab-inventory" class="tab-panel active">
              <div id="inventoryList">
                <!-- Inventory items worden hier getoond -->
              </div>
            </div>

            <!-- Tools Tab -->
            <div id="tab-tools" class="tab-panel">
              <div class="tools-grid">
                <button class="tool-button" onclick="speelKnopKlikGeluid(); toggleWateringMode()" id="wateringButton">
                  🚿 Gieter
                </button>
                <button class="tool-button" onclick="speelKnopKlikGeluid(); toggleInfoMode()" id="infoButton">
                  🔍 Info
                </button>
                <button class="tool-button" onclick="speelWaterGeluid(); getWaterFromWell()">💧 Water</button>
                <button class="tool-button" onclick="speelGeldGeluid(); interactWithShop()">🏪 Winkel</button>
                <button class="tool-button" onclick="speelGeldGeluid(); interactWithIceCreamShop()">
                  🍦 IJswinkel
                </button>
                <button class="tool-button" onclick="speelKnopKlikGeluid(); interactWithIceCreamMachine()">
                  🏭 IJsmachine
                </button>
                <button
                  class="tool-button greenhouse-button"
                  onclick="speelKnopKlikGeluid(); interactWithGreenhouse()"
                  id="greenhouseButton"
                  style="display: none"
                >
                  🏡 Kas
                </button>
              </div>

              <!-- Movement controls (compact) -->
              <div class="movement-section">
                <h4>🚶 Beweging</h4>
                <div class="movement-grid">
                  <div></div>
                  <button class="move-btn" onclick="speelKnopKlikGeluid('laag'); movePlayer('up')">⬆️</button>
                  <div></div>
                  <button class="move-btn" onclick="speelKnopKlikGeluid('laag'); movePlayer('left')">⬅️</button>
                  <div class="move-center">🧑‍🌾</div>
                  <button class="move-btn" onclick="speelKnopKlikGeluid('laag'); movePlayer('right')">➡️</button>
                  <div></div>
                  <button class="move-btn" onclick="speelKnopKlikGeluid('laag'); movePlayer('down')">⬇️</button>
                  <div></div>
                </div>
                <small>Of gebruik pijltjestoetsen / WASD</small>
              </div>
            </div>

            <!-- Season Tab -->
            <div id="tab-season" class="tab-panel">
              <div id="seasonInfo">
                <!-- Season information will be displayed here -->
              </div>
            </div>
          </div>

          <!-- Action Buttons (Always Visible) -->
          <div class="action-buttons">
            <button class="action-btn sleep-btn" onclick="speelKnopKlikGeluid('belangrijk'); sleep()">
              😴 Ga Slapen
            </button>

            <div class="utility-buttons">
              <button class="util-btn settings-btn" onclick="speelKnopKlikGeluid(); openSettingsModal()">
                ⚙️ Instellingen
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="messageArea"></div>

      <!-- Instellingen Modal -->
      <div id="settingsModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2>⚙️ Instellingen</h2>
            <span class="close" onclick="speelKnopKlikGeluid(); closeSettingsModal()">&times;</span>
          </div>
          <div class="modal-body">
            <!-- Geluid Instellingen -->
            <div class="settings-section">
              <h3>🔊 Geluid</h3>
              <div class="settings-row">
                <label>Muziek:</label>
                <div class="settings-controls">
                  <select
                    id="musicSelect"
                    class="settings-select"
                    onchange="speelMenuToggleGeluid(true); window.setSongType(this.value)"
                  >
                    <option value="main">Barok (Vivaldi)</option>
                    <option value="spring">Voorjaar (vrolijk)</option>
                  </select>
                  <button
                    class="settings-btn"
                    id="musicToggleBtn"
                    onclick="speelKnopKlikGeluid(); window.toggleMusic()"
                  >
                    🎵 Muziek aan
                  </button>
                </div>
              </div>
              <div class="settings-row">
                <label>Geluidseffecten:</label>
                <button class="settings-btn" id="soundToggleBtn" onclick="toggleGeluidseffecten(); updateSoundButton()">
                  🔊 Geluid aan
                </button>
              </div>
            </div>

            <!-- Spel Beheer -->
            <div class="settings-section">
              <h3>🎮 Spel Beheer</h3>
              <div class="settings-row">
                <label>Nieuw spel starten:</label>
                <button class="settings-btn danger" onclick="speelKnopKlikGeluid('belangrijk'); startNewGame()">
                  🔄 Nieuw Spel
                </button>
              </div>
              <div class="settings-row">
                <label>Voortgang opslaan:</label>
                <button class="settings-btn" onclick="speelKnopKlikGeluid(); exportGameData()">💾 Export</button>
              </div>
              <div class="settings-row">
                <label>Voortgang laden:</label>
                <button class="settings-btn" onclick="speelKnopKlikGeluid(); importGameData()">📂 Import</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript bestanden -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <!-- Data modules (laden eerst) -->
    <script src="js/data/crops.js"></script>
    <script src="js/data/iceCreams.js"></script>
    <!-- Utility modules -->
    <script src="js/utils/saveLoad.js"></script>
    <!-- System modules -->
    <script src="js/systems/muziek.js"></script>
    <script src="js/systems/geluidseffecten.js"></script>
    <script src="js/systems/gameState.js"></script>
    <script src="js/systems/customers.js"></script>
    <script src="js/systems/ui.js"></script>
    <!-- Component modules -->
    <script src="js/components/farm.js"></script>
    <script src="js/components/game.js"></script>
    <script src="js/components/movement.js"></script>
    <!-- UI modules -->
    <script src="js/ui/shop.js"></script>
    <script src="js/ui/shop-interaction.js"></script>
    <script src="js/ui/ice-cream-shop.js"></script>
    <script src="js/ui/ice-cream-machine.js"></script>
    <!-- Main game loop -->
    <script src="main.js"></script>
    <script>
      // Beginscherm functionaliteit
      function toonBeginschermStats() {
        // Probeer stats uit DOM te halen (of fallback)
        document.getElementById("begin-money").textContent = document.getElementById("money")?.textContent || "0";
        document.getElementById("begin-seeds").textContent = document.getElementById("seedCount")?.textContent || "0";
        document.getElementById("begin-fruit").textContent = document.getElementById("fruitCount")?.textContent || "0";
        document.getElementById("begin-ice").textContent = document.getElementById("iceCreamCount")?.textContent || "0";
        document.getElementById("begin-water").textContent = document.getElementById("water")?.textContent || "0";
        document.getElementById("begin-day").textContent = document.getElementById("day")?.textContent || "1";
        document.getElementById("begin-season").textContent = document.getElementById("season")?.textContent || "Lente";
      }
      function hideBeginschermEnStartSpel() {
        document.getElementById("startscreen").style.display = "none";
        var gc = document.getElementById("gameContainer");
        gc.classList.remove("startscreen-blur");
        // Start muziek als die aan staat
        if (window.musicEnabled !== false && typeof window.startMusic === "function") {
          window.startMusic();
        } else if (window.toggleMusic && document.getElementById("musicToggleBtn")?.textContent?.includes("aan")) {
          // Fallback: als knop zegt "aan", muziek starten
          window.toggleMusic();
        }
      }
      document.addEventListener("DOMContentLoaded", function () {
        toonBeginschermStats();
        document.getElementById("gameContainer").classList.add("startscreen-blur");
        document.getElementById("startSpelBtn").addEventListener("click", hideBeginschermEnStartSpel);
      });
    </script>
    <script>
      // Zet juiste tekst op muziekknop en geluidknop bij laden
      if (window.updateMusicButton) updateMusicButton();
      if (window.updateSoundButton) updateSoundButton();
      else {
        window.addEventListener("DOMContentLoaded", function () {
          if (window.updateMusicButton) updateMusicButton();
          if (window.updateSoundButton) updateSoundButton();
        });
      }
    </script>
  </body>
</html>
